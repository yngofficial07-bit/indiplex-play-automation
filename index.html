<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>INDIPLEX | Aesthetic Cinema</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r121/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Syncopate:wght@800&family=Orbitron:wght@400;900&family=Roboto:wght@300;400;700&family=Montserrat:wght@200;900&display=swap');
        
        :root { --red: #ff0000; --glass: rgba(255, 255, 255, 0.1); }

        body, html { margin: 0; padding: 0; background: #000; color: white; font-family: 'Roboto', sans-serif; overflow-x: hidden; }

        /* --- INTRO (ABYSSAL VOID) --- */
        #intro { height: 100vh; width: 100%; display: flex; justify-content: center; align-items: center; background: #000; position: fixed; z-index: 99999; transition: opacity 1.2s; top:0; left:0; }
        #abyss-canvas { position: absolute; inset: 0; }
        .silver-block { position: relative; width: 80vw; height: 30vh; background: linear-gradient(135deg, #000, #fff, #000); background-size: 200%; border-radius: 4px; display: flex; justify-content: center; align-items: center; animation: chromeFlow 5s linear infinite; opacity: 0; transform: scale(0.5); animation: arrive 2s forwards 3s; }
        @keyframes arrive { to { opacity: 1; transform: scale(1); } }
        @keyframes chromeFlow { 0% { background-position: 0%; } 100% { background-position: 200%; } }
        .indiplex-brand { font-family: 'Syncopate'; font-size: 8vw; color: #000; mix-blend-mode: multiply; letter-spacing: 5px; }

        /* --- NAV & SEARCH (FIXED) --- */
        nav { position: fixed; top: 0; width: 100%; height: 80px; z-index: 10000; display: flex; justify-content: space-between; align-items: center; padding: 0 5%; background: rgba(0,0,0,0.9); backdrop-filter: blur(20px); border-bottom: 1px solid var(--glass); box-sizing: border-box; }
        
        .search-container { position: relative; z-index: 10001; }
        #searchInput { 
            background: rgba(255,255,255,0.1); border: 1px solid #444; color: white; 
            padding: 10px 15px; border-radius: 20px; width: 140px; outline: none;
            pointer-events: auto !important; cursor: text !important;
        }
        #searchInput:focus { width: 200px; border-color: var(--red); }

        /* --- SIDEBAR --- */
        #side-menu { 
            position: fixed; top: 0; right: -320px; width: 310px; height: 100%; 
            background: rgba(10,10,10,0.98); z-index: 15000; transition: 0.5s; 
            padding: 80px 20px; border-left: 1px solid var(--glass);
        }
        #side-menu.active { right: 0; }
        .menu-item { padding: 18px; color: #888; cursor: pointer; border-bottom: 1px solid #222; font-family: 'Montserrat'; font-size: 14px; display: flex; align-items: center; gap: 10px; }
        .menu-item:hover { color: #fff; background: rgba(255,0,0,0.1); }

        /* --- MAIN UI --- */
        #vanta-canvas { position: fixed; inset: 0; z-index: 1; }
        #home-page { display: none; position: relative; z-index: 10; padding-top: 100px; }
        .container { padding: 0 5% 40px; display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; }
        
        /* --- 3D RGB CARDS --- */
        .card { position: relative; border-radius: 15px; overflow: hidden; background: #000; cursor: pointer; transition: 0.5s; height: 280px; transform-style: preserve-3d; }
        .card::before { content: ""; position: absolute; inset: -2px; background: conic-gradient(from 0deg, #ff0000, #00d2ff, #ff0000); animation: rotate 4s linear infinite; z-index: -1; opacity: 0; }
        .card:hover::before { opacity: 1; }
        .card:hover { transform: translateY(-10px) rotateY(10deg); }
        .card img { width: 100%; height: 220px; object-fit: cover; }
        .card h3 { font-size: 11px; text-align: center; padding: 10px; margin: 0; }
        @keyframes rotate { 100% { transform: rotate(360deg); } }

        /* --- SERIES & PLAYER OVERLAYS --- */
        #details-overlay { position: fixed; inset: 0; background: #000; display: none; z-index: 20000; overflow-y: auto; padding: 60px 5%; }
        .season-btn { background: #222; border: 1px solid #444; color: #fff; padding: 8px 15px; margin-right: 10px; border-radius: 4px; cursor: pointer; }
        .season-btn.active { background: var(--red); }
        .ep-card { background: #111; padding: 15px; margin: 10px 0; border-radius: 8px; cursor: pointer; border: 1px solid #222; }
        .ep-card:hover { border-color: var(--red); }

        #player-ui { position: fixed; inset: 0; background: #000; display: none; z-index: 30000; }
    </style>
</head>
<body>

<div id="intro">
    <canvas id="abyss-canvas"></canvas>
    <div class="silver-block"><h1 class="indiplex-brand">INDIPLEX</h1></div>
</div>

<div id="vanta-canvas"></div>

<div id="home-page">
    <nav>
        <div onclick="logoTrigger()" style="cursor:pointer;">
            <div style="font-family:'Orbitron'; font-weight:900; font-size:24px; color:white;">INDIPLEX</div>
            <div style="font-size:7px; color:#666; letter-spacing:1px;">YOUR PRIVACY IS OUR RESPONSIBILITY</div>
        </div>
        <div style="display:flex; align-items:center; gap:15px;">
            <div class="search-container">
                <input type="text" id="searchInput" oninput="searchGlobal(this.value)" placeholder="Search Movie...">
            </div>
            <div onclick="toggleMenu()" style="cursor:pointer; font-size:22px; color:white;"><i class="fa-solid fa-bars-staggered"></i></div>
        </div>
    </nav>

    <div id="search-section" style="display:none;">
        <h2 style="color:red; margin-left:5%;">SEARCH RESULTS <button onclick="clearSearch()" style="background:red; color:white; border:none; padding:5px 10px; border-radius:15px; font-size:10px; cursor:pointer;">X</button></h2>
        <div class="container" id="search-grid"></div>
    </div>

    <div id="main-content">
        <h2 style="color:red; border-left:4px solid red; padding-left:10px; margin-left:5%; font-family:'Orbitron'; font-size:14px;">PREMIUM SERIES</h2>
        <div class="container" id="series-grid"></div>
        <h2 style="color:red; border-left:4px solid red; padding-left:10px; margin-left:5%; font-family:'Orbitron'; font-size:14px;">TRENDING MOVIES</h2>
        <div class="container" id="popular-grid"></div>
    </div>
</div>

<div id="side-menu">
    <div onclick="toggleMenu()" style="text-align:right; font-size:30px; cursor:pointer; color:red;">&times;</div>
    <div class="menu-item" onclick="location.reload()"><i class="fa-solid fa-house"></i> HOME</div>
    <div class="menu-item" onclick="alert('Indiplex v3.0 - Abyssal Void')"><i class="fa-solid fa-circle-info"></i> ABOUT</div>
    <div id="logout-btn" class="menu-item" onclick="adminLogout()" style="display:none; color:red;"><i class="fa-solid fa-power-off"></i> LOGOUT ADMIN</div>
</div>

<div id="details-overlay">
    <div onclick="closeDetails()" style="position:fixed; top:20px; right:20px; font-size:40px; color:red; cursor:pointer;">&times;</div>
    <div id="details-body"></div>
</div>

<div id="player-ui">
    <div onclick="closePlayer()" style="position:fixed; top:20px; left:20px; font-size:25px; color:white; cursor:pointer; z-index:30001;">&larr; BACK</div>
    <iframe id="video-frame" style="width:100%; height:100%; border:none;" allowfullscreen></iframe>
</div>

<script>
    const API_KEY = 'fe6f0e951aff4fb2565255ce0d940fc6';
    let current = { id: null, type: 'movie', s: 1, e: 1 };

    // INTRO ANIMATION
    const canvas = document.getElementById('abyss-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    let parts = [];
    class Part { constructor() { this.x = Math.random()*canvas.width; this.y = Math.random()*canvas.height; this.z = Math.random()*canvas.width; } update() { this.z -= 2; if(this.z<=0) this.z = canvas.width; } draw() { let px = (this.x - canvas.width/2)*(canvas.width/this.z) + canvas.width/2; let py = (this.y - canvas.height/2)*(canvas.width/this.z) + canvas.height/2; let s = (1-this.z/canvas.width)*3; ctx.fillStyle="white"; ctx.beginPath(); ctx.arc(px,py,s,0,Math.PI*2); ctx.fill(); } }
    for(let i=0; i<200; i++) parts.push(new Part());
    function anim() { ctx.fillStyle="black"; ctx.fillRect(0,0,canvas.width,canvas.height); parts.forEach(p=>{p.update(); p.draw();}); requestAnimationFrame(anim); }
    anim();

    setTimeout(() => {
        document.getElementById('intro').style.opacity = '0';
        setTimeout(() => { 
            document.getElementById('intro').style.display = 'none'; 
            document.getElementById('home-page').style.display = 'block';
            VANTA.NET({ el: "#vanta-canvas", color: 0xff0000, backgroundColor: 0x0, points: 10 });
            loadData();
        }, 1000);
    }, 5000);

    // CORE FUNCTIONS
    async function loadData() {
        const m = await fetch(`https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&with_original_language=hi`);
        render('popular-grid', (await m.json()).results, 'movie');
        const s = await fetch(`https://api.themoviedb.org/3/tv/popular?api_key=${API_KEY}&with_original_language=hi`);
        render('series-grid', (await s.json()).results, 'tv');
    }

    function render(id, items, type) {
        document.getElementById(id).innerHTML = items.map(i => `
            <div class="card" onclick="handleSelect(${i.id}, '${type}')">
                <img src="https://image.tmdb.org/t/p/w500${i.poster_path}">
                <h3>${i.title || i.name}</h3>
            </div>`).join('');
    }

    async function handleSelect(id, type) {
        if(type==='movie') { current = {id, type}; openPlayer(); }
        else {
            const res = await fetch(`https://api.themoviedb.org/3/tv/${id}?api_key=${API_KEY}`);
            const data = await res.json();
            let h = `<h1 style="font-family:'Orbitron'">${data.name}</h1><div id="seasons">`;
            data.seasons.filter(s=>s.season_number>0).forEach(s=>{
                h += `<button class="season-btn" id="sb-${s.season_number}" onclick="fetchEpisodes(${id}, ${s.season_number})">Season ${s.season_number}</button>`;
            });
            h += `</div><div id="ep-list" style="margin-top:20px"></div>`;
            document.getElementById('details-body').innerHTML = h;
            document.getElementById('details-overlay').style.display = 'block';
            fetchEpisodes(id, 1);
        }
    }

    async function fetchEpisodes(id, sNum) {
        current.id = id; current.type = 'tv'; current.s = sNum;
        document.querySelectorAll('.season-btn').forEach(b=>b.classList.remove('active'));
        document.getElementById(`sb-${sNum}`).classList.add('active');
        const res = await fetch(`https://api.themoviedb.org/3/tv/${id}/season/${sNum}?api_key=${API_KEY}`);
        const data = await res.json();
        document.getElementById('ep-list').innerHTML = data.episodes.map(e => `
            <div class="ep-card" onclick="playEp(${e.episode_number})"><b>EP ${e.episode_number}</b> : ${e.name}</div>
        `).join('');
    }

    function playEp(eNum) { current.e = eNum; openPlayer(); }
    function openPlayer() { 
        document.getElementById('player-ui').style.display = 'block'; 
        const link = current.type === 'movie' ? `https://vidsrc.cc/v2/embed/movie/${current.id}` : `https://vidsrc.cc/v2/embed/tv/${current.id}/${current.s}/${current.e}`;
        document.getElementById('video-frame').src = link;
    }

    function searchGlobal(q) {
        if(q.length<2) { clearSearch(); return; }
        fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API_KEY}&query=${q}`)
        .then(r=>r.json()).then(d=>{
            document.getElementById('search-section').style.display='block';
            document.getElementById('main-content').style.display='none';
            render('search-grid', d.results, 'movie');
        });
    }

    function clearSearch() { document.getElementById('searchInput').value=''; document.getElementById('search-section').style.display='none'; document.getElementById('main-content').style.display='block'; }
    function toggleMenu() { document.getElementById('side-menu').classList.toggle('active'); }
    function closeDetails() { document.getElementById('details-overlay').style.display='none'; }
    function closePlayer() { document.getElementById('player-ui').style.display='none'; document.getElementById('video-frame').src=''; }
</script>
</body>
</html>
